#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ›¡ï¸  Running Pre-Commit Verification..."

# 1. Static Code Analysis (Quality)
echo "ğŸ” Checking Code Quality..."
npx tsx scripts/audit-code-quality.ts
if [ $? -ne 0 ]; then
  echo "âŒ Code Quality Audit Failed! Please fix issues before committing."
  exit 1
fi

# 2. Security Checks
echo "ğŸ”’ Checking Security Fixes..."
npx tsx scripts/verify-fixes.ts
if [ $? -ne 0 ]; then
  echo "âŒ Security Verification Failed! Run 'npx tsx scripts/verify-fixes.ts' to debug."
  exit 1
fi

echo "âœ… All Checks Passed! Committing..."
